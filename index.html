<!DOCTYPE html>
<html lang="vi">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>Sơ đồ tổ chức UBND - Đầy đủ và có thể chỉnh sửa</title>
  <script src="https://cdn.jsdelivr.net/npm/orgchart/dist/js/orgchart.js"></script> <!-- Đảm bảo bạn sử dụng CDN chính thức hoặc tải OrgChart.js từ nơi bạn lưu trữ -->
  <style>
    html, body { margin: 0; padding: 0; width: 100%; height: 100%; }
    #tree { width: 100%; height: 100vh; overflow: hidden; position: relative; }
    .oc-edit-button { margin-top: 10px; font-size: 14px; }
    #zoom-controls {
      position: absolute;
      top: 10px;
      right: 10px;
      z-index: 1000;
    }
    #zoom-controls button {
      font-size: 20px;
      padding: 5px 10px;
      background-color: #039be5;
      color: white;
      border: none;
      cursor: pointer;
      margin: 5px;
      border-radius: 5px;
    }
    #zoom-controls button:hover {
      background-color: #0288d1;
    }
  </style>
</head>
<body>
  <div id="zoom-controls">
    <button id="expand-all">+</button>
    <button id="collapse-all">-</button>
  </div>

  <div id="tree" class="boc-light">
    <!-- OrgChart SVG will be rendered here -->
  </div>

  <script>
    var chart = new OrgChart(document.getElementById("tree"), {
      template: "ana",
      enableSearch: true,
      nodeBinding: {
        field_0: "name",
        field_1: "title"
      },
      tags: {
        centered: {
          node: {
            name: { align: "center" },
            title: { align: "center" }
          }
        }
      },
      editForm: {
        titleBinding: "title",
        elements: [
          { type: 'textbox', label: 'Tên', binding: 'name' },
          { type: 'textbox', label: 'Chức vụ', binding: 'title' },
          { type: 'textbox', label: 'Số điện thoại', binding: 'phone' },
          { type: 'textbox', label: 'Nhiệm vụ', binding: 'task' }
        ]
      },
      nodeMenu: {
        edit: { 
          text: "Chỉnh sửa", 
          click: function (event, node) {
            const name = prompt("Nhập tên:", node.name);
            const title = prompt("Nhập chức vụ:", node.title);
            const phone = prompt("Nhập số điện thoại:", node.phone || "");
            const task = prompt("Nhập nhiệm vụ:", node.task || "");
            node.name = name;
            node.title = title;
            node.phone = phone;
            node.task = task;
            localStorage.setItem('orgchartData', JSON.stringify(chart.nodes));
            chart.refresh();
          }
        },
        add: { text: "Thêm cấp dưới" },
        remove: { text: "Xóa" }
      },
      nodes: [
        { id: 1, name: "Phạm Xuân Nam", title: "CHỦ TỊCH UBND", tags: ["centered"] },
        { id: 2, pid: 1, name: "Trần Quốc Tuấn", title: "PHÓ CHỦ TỊCH – GIÁM ĐỐC TTHCC", tags: ["centered"] },
        { id: 3, pid: 2, name: "Lê Thị Kiều Trang", title: "PHÓ GIÁM ĐỐC TTHCC", tags: ["centered"] },
        { id: 4, pid: 1, name: "Nguyễn Thanh Tú", title: "PHÓ CHỦ TỊCH", tags: ["centered"] },
        { id: 5, pid: 4, name: "Nguyễn Thế Vinh", title: "CHÁNH VP HĐND-UBND", tags: ["centered"] },
        { id: 6, pid: 5, name: "Nguyễn Lê Trường Hải", title: "PHÓ CHÁNH VP", tags: ["centered"] },
        { id: 7, pid: 4, name: "Nguyễn Thị Thanh Hà", title: "TRƯỞNG PHÒNG VH-XH", tags: ["centered"] },
        { id: 8, pid: 7, name: "Lý Trường Kỳ", title: "PHÓ TRƯỞNG PHÒNG VĂN HÓA", tags: ["centered"] },
        { id: 9, pid: 8, name: "Phạm Thị Huỳnh Diệp", title: "TỔ NỘI VỤ - CCHC", tags: ["centered"] },
        // Continue adding other nodes...
      ]
    });

    // Expand all nodes (show all subordinates)
    document.getElementById('expand-all').addEventListener('click', function() {
      chart.nodes.forEach(function(node) {
        node._hidden = false; // Show all nodes
      });
      chart.refresh(); // Re-render the chart with all nodes visible
    });

    // Collapse all nodes (hide all subordinates)
    document.getElementById('collapse-all').addEventListener('click', function() {
      chart.nodes.forEach(function(node) {
        if (node.pid) { // If it has a parent (subordinate), hide it
          node._hidden = true;
        }
      });
      chart.refresh(); // Re-render the chart with only the root nodes visible
    });
  </script>

</body>
</html>
